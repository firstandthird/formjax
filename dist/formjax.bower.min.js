/*!
 * formjax - Submit a form via ajax
 * v0.1.0
 * 
 * copyright First+Third 2014
 * MIT License
*/
!function(a){a.declare("formjax",{defaults:{submitButton:"[type=submit]",progressClass:"btn-progress",successClass:"btn-success",errorClass:"btn-error",progressText:"Sending...",successText:"Done!",errorText:"Uh oh",successRedirect:!1,successRefresh:!1,validate:function(){return!0},success:function(){},error:function(){}},events:{submit:"submit"},init:function(){this.button=this.el.find(this.submitButton)},submit:function(b){b.preventDefault(),this.validate()&&(this.button.addClass(this.progressClass).val(this.progressText),a.post(this.el.attr("action"),this.el.serialize()).done(this.proxy(this._success)).fail(this.proxy(this._error)))},_success:function(a){this.button.removeClass(this.progressClass).addClass(this.successClass),"INPUT"==this.button[0].tagName?this.button.val(this.successText):this.button.text(this.successText),this.emit("formjax:success",a),this.success.call(this.el,a),this.successRefresh&&window.location.reload(),this.successRedirect&&(window.location=this.successRedirect)},_error:function(b){this.button.removeClass(this.progressClass).addClass(this.errorClass).val(this.errorText),a.notice(b.responseJSON.message,{level:"error"}),this.emit("formjax:error",b),this.error.call(this.el,b)}})}(jQuery);